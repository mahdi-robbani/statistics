#week51w
BC_data <- read.table("breast-cancer-wisconsin.data", na.strings = "?", sep =",") #na.strings marks entries that will be converted to NAs

head(BC_data)
any(is.na(BC_data)) #Check for NAs
str(BC_data) #Used to find "?" before using na.strings

BC_data <- na.omit(BC_data) #removes all rows with at least one missing values

BC_data$V11[BC_data$V11 == 2] = "B"
BC_data$V11[BC_data$V11 == 4] = "M"

BC_data$V11 <- factor(BC_data$V11, levels = c("B", "M")) # order matters, M is the success

#We are assuming error is binomial
glm_model <- glm(V11 ~ . - V1, data = BC_data, family = "binomial")

#results are the coefficients for the equation. the higher the coefficient the more if affects y,
#so it means that variable is very important to prediction
#This model does not take into account how the variables interact with each other.

?predict
#I want to use this moel to predict
summary(glm_model)

predictions <- predict(glm_model, type = "response")

#If no data is given, predict works with training data. Not 100% accurate since this is a basic model
#Use type = response to output probability

plot(BC_data$V11, predictions)

pred_BM <- factor(sapply(predictions, function(x) ifelse(x <0.5, "B", "M")), levels = c("B", "M"))
pred_table <- table(BC_data$V11, pred_BM) # confusion table
error_BM <- sum(pred_table) - sum(diag(pred_BM))
error_BM/sum(pred_table)
accuracy <- sum(diag(pred_table)) / sum(pred_table)
accuracy                  

small_model <-glm(V11 ~ V2 + V7, data = BC_data, family = "binomial")
small_model2 <-glm(V11 ~ V2 + V8 + V10, data = BC_data, family = "binomial")
summary(small_model)

AIC(glm_model, small_model)
AIC(glm_model, small_model2)
anova(glm_model, small_model, test = "LRT") #H_0 is the two models are the same, low p value means we reject so models are different
